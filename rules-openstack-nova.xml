<group name="openstack,nova,">

<rule id="100100" level="0">
    <decoded_as>nova-api-log</decoded_as>
    <description>OpenStack Nova API base log</description>
  </rule>

  <rule id="100200" level="0">
    <decoded_as>nova-computed-log</decoded_as>
    <description>OpenStack Nova Compute base log</description>
  </rule>

  <rule id="100300" level="0">
    <decoded_as>nova-scheduler-log</decoded_as>
    <description>OpenStack Nova Scheduler base log</description>
  </rule>

<rule id="100101" level="0">
    <if_sid>100100</if_sid>
    <field name="log_level">INFO</field>
    <description>Nova API: INFO log received.</description>
  </rule>

  <rule id="100102" level="5">
    <if_sid>100100</if_sid>
    <field name="log_level">WARNING</field>
    <description>Nova API: General WARNING log.</description>
  </rule>

  <rule id="100103" level="8">
    <if_sid>100100</if_sid>
    <field name="log_level">ERROR</field>
    <description>Nova API: General ERROR log.</description>
  </rule>

  <rule id="100201" level="0">
    <if_sid>100200</if_sid>
    <field name="log_level">INFO</field>
    <description>Nova Compute: INFO log received.</description>
  </rule>

  <rule id="100202" level="5">
    <if_sid>100200</if_sid>
    <field name="log_level">WARNING</field>
    <description>Nova Compute: General WARNING log.</description>
  </rule>

  <rule id="100301" level="0">
    <if_sid>100300</if_sid>
    <field name="log_level">INFO</field>
    <description>Nova Scheduler: INFO log received.</description>
  </rule>

<rule id="100110" level="10">
    <if_sid>100103</if_sid> <field name="module">keystonemiddleware.auth_token</field>
    <description>Nova API: Kegagalan Autentikasi. Pesan: $(message)</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>

  <rule id="100210" level="7">
    <if_sid>100202</if_sid> <field name="module">nova.compute.manager</field>
    <match>While synchronizing instance power states</match>
    <description>Nova Compute: Ketidaksesuaian status instance antara database dan hypervisor. Pesan: $(message)</description>
    <group>configuration_error,service_availability,</group>
  </rule>

  <rule id="100211" level="6">
    <if_sid>100202</if_sid> <field name="module">nova.virt.libvirt.imagecache</field>
    <match>Unknown base file</match>
    <description>Nova Compute: Ditemukan base image yang tidak dikenali di cache. Pesan: $(message)</description>
    <group>service_availability,</group>
  </rule>

  <rule id="100120" level="8">
    <if_sid>100100</if_sid>
    <field name="http_status" type="pcre2">^5\d\d$</field> <description>Nova API: HTTP Server Error $(http_status) pada $(http_path)</description>
    <group>web_server_errors,service_availability,</group>
  </rule>
  <rule id="100121" level="5">
    <if_sid>100100</if_sid>
    <field name="http_status" type="pcre2">^4\d\d$</field> <description>Nova API: HTTP Client Error $(http_status) pada $(http_path)</description>
    <group>web_server_errors,access_denied,</group>
  </rule>

</group>
